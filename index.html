<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM 프롬프팅 실습</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- 왼쪽 사이드바 -->
        <aside class="sidebar">
            <h1>⚙️ 설정</h1>

            <!-- API 설정 -->
            <section class="sidebar-section">
                <h3>🔑 API 설정</h3>
                <div class="input-group">
                    <label for="apiKey">API Key:</label>
                    <input type="password" id="apiKey" placeholder="Google AI Studio API Key">
                    <button id="saveApiKey" class="btn btn-primary btn-sm">저장</button>
                </div>
                <div class="input-group">
                    <label for="modelSelect">모델:</label>
                    <select id="modelSelect" disabled>
                        <option value="">API Key를 먼저 입력하세요</option>
                    </select>
                </div>
            </section>

            <!-- 변수 관리 -->
            <section class="sidebar-section">
                <div class="section-header">
                    <h3>🔤 변수 관리</h3>
                    <button id="addVariableBtn" class="btn btn-icon" title="변수 추가">+</button>
                </div>
                <div id="variablesList" class="variables-list">
                    <!-- 동적으로 생성됨 -->
                </div>
                <p class="hint">💡 프롬프트에서 ${변수명} 형식으로 사용</p>
            </section>

            <!-- 모델 파라미터 -->
            <section class="sidebar-section">
                <h3>🎛️ 모델 파라미터</h3>

                <div class="param-group">
                    <label for="temperature">Temperature: <span id="tempValue">0.7</span></label>
                    <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7">
                    <small>낮을수록 일관적, 높을수록 창의적</small>
                </div>

                <div class="param-group">
                    <label for="maxTokens">Max Tokens:</label>
                    <input type="number" id="maxTokens" value="1000" min="1" max="8000">
                    <small>최대 응답 길이</small>
                </div>

                <div class="param-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="jsonMode">
                        <span>JSON 모드</span>
                    </label>
                    <small>JSON 형식으로 응답 요청</small>
                </div>
            </section>
        </aside>

        <!-- 오른쪽 메인 영역 -->
        <main class="main-content">
            <h1>🤖 LLM 프롬프팅 실습</h1>

            <!-- 프롬프트 입력 -->
            <section class="prompt-section">
                <div class="input-group">
                    <label for="systemPrompt">프롬프트:</label>
                    <textarea id="systemPrompt" placeholder="예: 당신은 ${childName}의 선생님입니다. ${childName}이(가) ${subject} 시험에서 ${score}점을 받았습니다." rows="8" disabled></textarea>
                </div>

                <div class="input-group">
                    <label for="userInput">추가 입력 (선택):</label>
                    <textarea id="userInput" placeholder="추가 사용자 메시지 (선택 사항)..." rows="3" disabled></textarea>
                </div>

                <!-- Preview 섹션 -->
                <div class="preview-section" id="previewSection" style="display: none;">
                    <div class="preview-header">
                        <h4>👁️ 최종 프롬프트 미리보기</h4>
                        <button id="togglePreview" class="btn btn-sm">닫기</button>
                    </div>
                    <pre id="previewContent" class="preview-box"></pre>
                </div>

                <div class="button-group">
                    <button id="previewBtn" class="btn btn-secondary" disabled>미리보기</button>
                    <button id="submitBtn" class="btn btn-primary btn-large" disabled>
                        <span id="btnText">전송</span>
                        <span id="btnLoading" class="loading" style="display: none;">처리 중...</span>
                    </button>
                </div>
            </section>

            <!-- 후처리 옵션 -->
            <section class="postprocess-section">
                <div class="postprocess-header" id="postprocessHeader">
                    <h3>📝 후처리 옵션</h3>
                    <span class="toggle-icon">▼</span>
                </div>
                <div class="postprocess-options" id="postprocessOptions">
                    <label class="checkbox-label">
                        <input type="checkbox" id="removeEmojis">
                        <span>이모지 제거</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="removeMarkdown">
                        <span>마크다운 제거</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="extractCodeBlocks">
                        <span>코드 블록만 추출</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="removeExtraSpaces">
                        <span>공백/줄바꿈 정리</span>
                    </label>
                </div>
            </section>

            <!-- 결과 -->
            <section class="result-section">
                <div class="result-header">
                    <h2>📄 결과</h2>
                    <button id="copyBtn" class="btn btn-copy" style="display: none;">
                        📋 복사하기
                    </button>
                </div>

                <!-- 성능 메트릭 -->
                <div id="performanceMetrics" class="performance-metrics" style="display: none;">
                    <div class="metric-card">
                        <span class="metric-label">⏱️ Latency</span>
                        <span class="metric-value" id="latencyValue">-</span>
                    </div>
                    <div class="metric-card">
                        <span class="metric-label">📥 Input Tokens</span>
                        <span class="metric-value" id="inputTokens">-</span>
                    </div>
                    <div class="metric-card">
                        <span class="metric-label">📤 Output Tokens</span>
                        <span class="metric-value" id="outputTokens">-</span>
                    </div>
                    <div class="metric-card">
                        <span class="metric-label">✅ Parsing Status</span>
                        <span class="metric-value" id="parsingStatus">-</span>
                    </div>
                </div>

                <!-- 출력 비교 (Raw vs Processed) -->
                <div id="outputComparison" class="output-comparison" style="display: none;">
                    <div class="output-column">
                        <h4>📄 Raw Output (원본)</h4>
                        <div id="rawOutput" class="output-box"></div>
                    </div>
                    <div class="output-column">
                        <h4>✨ Processed Output (가공)</h4>
                        <div id="processedOutput" class="output-box"></div>
                    </div>
                </div>

                <!-- 기존 단일 결과 박스 -->
                <div id="result" class="result-box">
                    <p class="placeholder">여기에 결과가 표시됩니다.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- 에러 모달 -->
    <div id="errorModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>⚠️ 오류</h2>
            <p id="errorMessage"></p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
